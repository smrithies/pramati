1.Manager Name, Count of Employees whose start date is after 2013

select m.name as "Manager name" ,count(e.emp_id) as "Count of Employee" from employee e,employee m where e.mgr_id=m.emp_id and extract(Year from e.joining_date) >'2013' group by m.name order by m.name ;

2.Manager Name, Min(emp salary) where manager start date is after 2013
select b.name as dept_name,min(a.salary) as min_salary from dept d,employee a,employee b where a.mgr_id = b.emp_id and b.dept_id = d.dept_id and extract(year from b.joining_date)>2013 group by d.name;


3.Manager name who atleast has two employees started after 2013

SELECT b.name as Mgr_Name FROM employee a, employee b WHERE b.emp_id = a.mgr_id and EXTRACT(YEAR FROM a.joining_date)>2013 group by b.name having count(a.name) >=2;

4.Dept Name, Count of Employees whose start date is after 2013

select d.name,count(e.name) from employee e,dept d where d.dept_id=e.dept_id and extract(year from e.joining_date)>2013 group by d.name;

5.Dept Name, Min(emp salary) where manager start date is after 2013
select b.name as dept_name,min(a.salary) as min_salary from dept d,employee a,employee b where a.mgr_id = b.emp_id and b.dept_id = d.dept_id and extract(year from b.joining_date)>2013 group by d.name;
 


6.Dept Name who atleast has two employees started after 2013

select d.name,count(e.name) from employee e,dept d where d.dept_id=e.dept_id and extract(year from e.joining_date)>2013 group by d.name having count(e.name)>=2;

7. Number of employees per year
select count(name) as emp_count,EXTRACT(year from joining_date) from employee group by EXTRACT(year from joining_date);

8. Number of employees per year, per department
select extract(year from e.joining_date) ,d.name,count(e.emp_id) from employee e,dept d where e.dept_id=d.dept_id group by extract(year from e.joining_date),d.name order by d.name;

9.List of Months (Say, Jan-2018) where number of employees joined is more than 2

select extract(year from joining_date) as YEAR,extract(month from joining_date) as Month ,count(emp_id) as Count from employee group by extract(year from joining_date),extract(month from joining_date) having count(emp_id)>2;

10.List of Managers who has employees from more than one department

select m.name from employee e,employee m,dept d where e.mgr_id=m.emp_id and e.dept_id=d.dept_id group by m.name having count(distinct d.name)>1;

11.List of Departments who has atleast two managers
select d.name,count(distinct m.name) from employee e,employee m,dept d where e.mgr_id=m.emp_id and m.dept_id=d.dept_id group by d.name having count(distinct m.name)>=2;

12.Employee Names who joined after 2013 and his manager has more than two reportees

select a.name from employee a,employee b where b.emp_id=a.mgr_id and a.joining_date>'01-01-2013'and (select count(a.name) from employee a,employee b where b.emp_id = a.mgr_id )>2;


